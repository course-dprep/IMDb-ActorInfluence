---
title: "Group Assignment Skills: Data Prep.&Workflow Mgt"
author: "Team 5"
date: "2024-09-06"
output: pdf_document
---

## Team 5
#Sophie van Hest
#Eveline Cai
#Mette Swanenberg
#Tyamo van der Ceelen

## Research Motivation

Our research question is: **Does an actor influence IMDb popularity ratings of a movie?**
By examining the impact of A-list actors, particularly award winners, on IMDb ratings, this study explores:
- How casting major stars boosts a film’s visibility and box office success.
- Whether well-known actors can raise audience interest and market expectations.
- How star power influences consumer behavior, especially on streaming platforms.
This research aims to guide production and marketing strategies by understanding the role of star actors in driving both film success and audience ratings.

## Data
Data1 includes:

- nconst (string) - alphanumeric unique identifier of the name/person
- primaryName (string)– name by which the person is most often credited
- birthYear – in YYYY format
- deathYear – in YYYY format if applicable, else '\\N'
- primaryProfession (array of strings)– the top-3 professions of the person
- knownForTitles (array of tconsts) – titles the person is known for

Data2 includes:

- tconst (string) - alphanumeric unique identifier of the title
- averageRating – weighted average of all the individual user ratings
- numVotes - number of votes the title has received

Data3 includes:
- tconst (string) - alphanumeric unique identifier of the title
- titleType (string) – the type/format of the title (e.g. movie, short, tvseries, tvepisode, video, etc)
- primaryTitle (string) – the more popular title / the title used by the filmmakers on promotional materials    at the point of release
- originalTitle (string) - original title, in the original language
- isAdult (boolean) - 0: non-adult title; 1: adult title
- startYear (YYYY) – represents the release year of a title. In the case of TV Series, it is the series start     year
- endYear (YYYY) – TV Series end year. '\N' for all other title types
- runtimeMinutes – primary runtime of the title, in minutes
- genres (string array) – includes up to three genres associated with the title

```{r echo=FALSE, warning=FALSE}
url1 <- "https://datasets.imdbws.com/name.basics.tsv.gz"
url2 <- "https://datasets.imdbws.com/title.ratings.tsv.gz"
url3 <- "https://datasets.imdbws.com/title.basics.tsv.gz"

file1 <- "name.basics.tsv.gz"
file2 <- "title.ratings.tsv.gz"
file3 <- "title.basics.tsv.gz"

if (!file.exists(file1)) {
  download.file(url1, file1)
}
if (!file.exists(file2)) {
  download.file(url2, file2)
}
if (!file.exists(file3)) {
  download.file(url3, file3)
}

data1 <- read.csv(gzfile(file1), sep = "\t")
data2 <- read.csv(gzfile(file2), sep = "\t")
data3 <- read.csv(gzfile(file3), sep = "\t")

```

#Data cleaning
```{r}
data1 <- na.omit(data1)
data2 <- na.omit(data2)
data3 <- na.omit(data3)
```

```{r}
# This code filters data1 to include only the rows where the primaryProfession column contains the words "actor" or "actress".
data1 <-  data1[grepl("actor|actress", data1$primaryProfession), ]
data3 <- data3[grepl("movie", data3$titleType), ]
```

```{r}
# removal of unnecessary columns
library(dplyr)
cdata1 <- data1 %>% select(primaryName, primaryProfession, knownForTitles)
cdata2 <- data2
cdata3 <- data3 %>% select(tconst, primaryTitle)
```

```{r}
# Split the 'knownForTitles' column into separate rows
library(tidyr)
cdata1 <- cdata1 %>%
  separate_rows(knownForTitles, sep = ",")
```

```{r}
cdata1 <- rename(cdata1, tconst = knownForTitles)
```


```{r}
# creating 1 dataset
data4 <- left_join(cdata2, cdata3, by = "tconst") 
data5 <- left_join(data4, cdata1, by = c("tconst"))
```

```{r}
# delete NA's
data <- na.omit(data5)
```

#Data Exploration

```{r}
#Top 10 Actors by Number of Known Titles
# Count the number of known titles for each actor
library(dplyr)

top_actors <- data %>%
  group_by(primaryName) %>%
  summarise(numTitles = n()) %>%
  arrange(desc(numTitles)) %>%
  head(10)

# Display the table
top_actors

```

```{r}
# Bar chart of top 10 actors with the most titles
ggplot(top_actors, aes(x = reorder(primaryName, -numTitles), y = numTitles)) +
  geom_bar(stat = "identity", fill = "pink") +
  labs(title = "Top 10 Actors by Number of Known Titles", x = "Actor", y = "Number of Titles") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
#IMDb Ratings Distribution
# Load required libraries for visualization
library(ggplot2)

# Create a histogram of IMDb ratings
ggplot(data, aes(x = averageRating)) +
  geom_histogram(binwidth = 0.5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of IMDb Ratings", x = "Average Rating", y = "Count of Movies") +
  theme_minimal()

```

```{r}
# Scatter plot of number of votes vs average rating
ggplot(data, aes(x = numVotes, y = averageRating)) +
  geom_point(alpha = 0.5, color = "red") +
  labs(title = "Number of Votes vs IMDb Ratings", x = "Number of Votes", y = "Average Rating") +
  theme_minimal()

```

```{r}
# Top 10 highest rated movies (Not sure if this one is accurate)
top_movies <- data %>%
  arrange(desc(averageRating)) %>%
  select(primaryTitle, averageRating, numVotes) %>%
  head(10)

# Display the table
top_movies

```



